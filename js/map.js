/**
 * Ground Score — Festival Map Feature
 * Interactive map showing festivals you've attended by year
 */

(function() {
    'use strict';
    
    const MAP_KEY = 'groundscore_map';
    
    // Festival coordinates (lat, lng)
    // Will be populated from festival data
        const FESTIVAL_COORDS = {
        'all-points-east': { lat: 51.5429, lng: -0.0402, name: 'All Points East', location: 'London, UK' },
        'amsterdam-dance-event': { lat: 52.3676, lng: 4.9041, name: 'Amsterdam Dance Event', location: 'Amsterdam, Netherlands' },
        'arc-music-festival': { lat: 41.8758, lng: -87.627, name: 'ARC Music Festival', location: 'Chicago, IL' },
        'arise': { lat: 40.015, lng: -105.2705, name: 'Arise', location: 'Loveland, CO' },
        'audioriver': { lat: 51.4028, lng: 21.1469, name: 'Audioriver', location: 'Płock, Poland' },
        'austin-city-limits': { lat: 30.2653, lng: -97.749, name: 'Austin City Limits', location: 'Austin, TX' },
        'awakenings': { lat: 52.3909, lng: 4.939, name: 'Awakenings', location: 'Amsterdam, Netherlands' },
        'balaton-sound': { lat: 46.72, lng: 17.62, name: 'Balaton Sound', location: 'Zamárdi, Hungary' },
        'bass-canyon': { lat: 47.1007, lng: -119.994, name: 'Bass Canyon', location: 'George, WA' },
        'beyond-wonderland-socal': { lat: 34.0689, lng: -117.648, name: 'Beyond Wonderland', location: 'San Bernardino, CA' },
        'bonnaroo': { lat: 35.4753, lng: -86.0559, name: 'Bonnaroo', location: 'Manchester, TN' },
        'boom-festival': { lat: 39.8167, lng: -7.75, name: 'Boom Festival', location: 'Idanha-a-Nova, Portugal' },
        'boomtown-fair': { lat: 51.1667, lng: -1.4667, name: 'Boomtown Fair', location: 'Hampshire, UK' },
        'buku': { lat: 29.9511, lng: -90.0715, name: 'BUKU', location: 'New Orleans, LA' },
        'burning-man': { lat: 40.7864, lng: -119.2065, name: 'Burning Man', location: 'Black Rock City, NV' },
        'camp-bisco': { lat: 42.54, lng: -74.9242, name: 'Camp Bisco', location: 'Scranton, PA' },
        'coachella': { lat: 33.6803, lng: -116.2389, name: 'Coachella', location: 'Indio, CA' },
        'countdown': { lat: 34.0689, lng: -117.648, name: 'Countdown', location: 'San Bernardino, CA' },
        'countdown-nye': { lat: 34.0689, lng: -117.648, name: 'Countdown NYE', location: 'San Bernardino, CA' },
        'creamfields': { lat: 53.2787, lng: -2.697, name: 'Creamfields', location: 'Daresbury, UK' },
        'crssd-festival': { lat: 32.7118, lng: -117.1579, name: 'CRSSD Festival', location: 'San Diego, CA' },
        'das-energi': { lat: 40.7608, lng: -111.891, name: 'Das Energi', location: 'Salt Lake City, UT' },
        'day-for-night': { lat: 29.7604, lng: -95.3698, name: 'Day for Night', location: 'Houston, TX' },
        'dead-rocks': { lat: 39.6655, lng: -105.2057, name: 'Dead Rocks', location: 'Morrison, CO' },
        'decadence-arizona': { lat: 33.4484, lng: -112.074, name: 'Decadence Arizona', location: 'Phoenix, AZ' },
        'decadence-colorado': { lat: 39.7392, lng: -104.9903, name: 'Decadence Colorado', location: 'Denver, CO' },
        'defected-croatia': { lat: 44.1283, lng: 15.2213, name: 'Defected Croatia', location: 'Tisno, Croatia' },
        'defqon-1': { lat: 52.181, lng: 5.72, name: 'Defqon.1', location: 'Biddinghuizen, Netherlands' },
        'dekmantel': { lat: 52.3702, lng: 4.8952, name: 'Dekmantel', location: 'Amsterdam, Netherlands' },
        'desert-daze': { lat: 33.6934, lng: -116.4142, name: 'Desert Daze', location: 'Lake Perris, CA' },
        'desert-hearts': { lat: 33.705, lng: -116.395, name: 'Desert Hearts', location: 'Los Coyotes, CA' },
        'dgtl-amsterdam': { lat: 52.3842, lng: 4.8918, name: 'DGTL Amsterdam', location: 'Amsterdam, Netherlands' },
        'dimensions-festival': { lat: 44.8666, lng: 13.85, name: 'Dimensions Festival', location: 'Pula, Croatia' },
        'dirtybird-campout': { lat: 35.6772, lng: -120.1625, name: 'Dirtybird Campout', location: 'Modesto, CA' },
        'dreamstate-sf': { lat: 37.7749, lng: -122.4194, name: 'Dreamstate SF', location: 'San Francisco, CA' },
        'edc-las-vegas': { lat: 36.27, lng: -115.0095, name: 'EDC Las Vegas', location: 'Las Vegas, NV' },
        'edc-mexico': { lat: 19.4326, lng: -99.1332, name: 'EDC Mexico', location: 'Mexico City, Mexico' },
        'edc-orlando': { lat: 28.3608, lng: -81.5507, name: 'EDC Orlando', location: 'Orlando, FL' },
        'electric-castle': { lat: 46.8722, lng: 23.7517, name: 'Electric Castle', location: 'Bonțida, Romania' },
        'electric-forest': { lat: 43.6508, lng: -85.9781, name: 'Electric Forest', location: 'Rothbury, MI' },
        'electric-zoo': { lat: 40.7935, lng: -73.9316, name: 'Electric Zoo', location: 'New York, NY' },
        'elements-lakewood': { lat: 41.8568, lng: -74.4654, name: 'Elements', location: 'Lakewood, PA' },
        'escape': { lat: 34.0689, lng: -117.648, name: 'Escape', location: 'San Bernardino, CA' },
        'exit-festival': { lat: 45.2561, lng: 19.8457, name: 'EXIT Festival', location: 'Novi Sad, Serbia' },
        'field-day': { lat: 51.5429, lng: -0.0402, name: 'Field Day', location: 'London, UK' },
        'firefly': { lat: 39.1882, lng: -75.5249, name: 'Firefly', location: 'Dover, DE' },
        'flow-festival': { lat: 60.1699, lng: 24.9384, name: 'Flow Festival', location: 'Helsinki, Finland' },
        'fusion-festival': { lat: 53.35, lng: 12.75, name: 'Fusion Festival', location: 'Lärz, Germany' },
        'garbicz-festival': { lat: 52.295, lng: 15.12, name: 'Garbicz Festival', location: 'Garbicz, Poland' },
        'gem-and-jam': { lat: 32.2226, lng: -110.9747, name: 'Gem and Jam', location: 'Tucson, AZ' },
        'glastonbury': { lat: 51.1503, lng: -2.5853, name: 'Glastonbury', location: 'Somerset, UK' },
        'governors-ball': { lat: 40.7935, lng: -73.9316, name: 'Governors Ball', location: 'New York, NY' },
        'hangout': { lat: 30.2803, lng: -87.5697, name: 'Hangout', location: 'Gulf Shores, AL' },
        'hard-summer': { lat: 34.0689, lng: -117.648, name: 'Hard Summer', location: 'San Bernardino, CA' },
        'heatwave': { lat: 41.882, lng: -87.619, name: 'Heatwave', location: 'Chicago, IL' },
        'hideout': { lat: 44.5333, lng: 14.9, name: 'Hideout Festival', location: 'Pag, Croatia' },
        'hijinx': { lat: 39.9526, lng: -75.1652, name: 'Hijinx', location: 'Philadelphia, PA' },
        'hulaween': { lat: 30.2394, lng: -83.0099, name: 'Hulaween', location: 'Live Oak, FL' },
        'iii-points': { lat: 25.786, lng: -80.1918, name: 'III Points', location: 'Miami, FL' },
        'imagine': { lat: 33.6409, lng: -84.4479, name: 'Imagine', location: 'Atlanta, GA' },
        'kappa-futur': { lat: 45.0703, lng: 7.6869, name: 'Kappa FuturFestival', location: 'Turin, Italy' },
        'leeds-festival': { lat: 53.9401, lng: -1.6667, name: 'Leeds Festival', location: 'Leeds, UK' },
        'let-it-roll': { lat: 50.4203, lng: 14.9081, name: 'Let It Roll', location: 'Milovice, Czech Republic' },
        'lightning-in-a-bottle': { lat: 35.6772, lng: -120.1625, name: 'Lightning in a Bottle', location: 'Bakersfield, CA' },
        'lollapalooza': { lat: 41.8758, lng: -87.6189, name: 'Lollapalooza', location: 'Chicago, IL' },
        'lost-in-dreams': { lat: 36.1069, lng: -115.1552, name: 'Lost in Dreams', location: 'Las Vegas, NV' },
        'lost-lands': { lat: 39.8953, lng: -82.8833, name: 'Lost Lands', location: 'Thornville, OH' },
        'love-international': { lat: 44.1283, lng: 15.2213, name: 'Love International', location: 'Tisno, Croatia' },
        'lowlands': { lat: 52.181, lng: 5.72, name: 'Lowlands', location: 'Biddinghuizen, Netherlands' },
        'medusa-festival': { lat: 39.9864, lng: -0.0513, name: 'Medusa Festival', location: 'Valencia, Spain' },
        'melt-festival': { lat: 51.57, lng: 12.297, name: 'Melt! Festival', location: 'Gräfenhainichen, Germany' },
        'movement': { lat: 42.3293, lng: -83.0458, name: 'Movement', location: 'Detroit, MI' },
        'mysteryland': { lat: 52.431, lng: 5.0676, name: 'Mysteryland', location: 'Haarlemmermeer, Netherlands' },
        'nature-one': { lat: 49.9833, lng: 7.5333, name: 'Nature One', location: 'Kastellaun, Germany' },
        'neversea': { lat: 44.1667, lng: 28.65, name: 'Neversea', location: 'Constanța, Romania' },
        'nocturnal-wonderland': { lat: 34.0689, lng: -117.648, name: 'Nocturnal Wonderland', location: 'San Bernardino, CA' },
        'north-coast': { lat: 41.882, lng: -87.619, name: 'North Coast', location: 'Chicago, IL' },
        'okeechobee': { lat: 27.2439, lng: -80.8295, name: 'Okeechobee', location: 'Okeechobee, FL' },
        'outlook-festival': { lat: 44.8666, lng: 13.85, name: 'Outlook Festival', location: 'Pula, Croatia' },
        'outside-lands': { lat: 37.7694, lng: -122.4862, name: 'Outside Lands', location: 'San Francisco, CA' },
        'panorama': { lat: 40.7935, lng: -73.9316, name: 'Panorama', location: 'New York, NY' },
        'parklife': { lat: 53.4808, lng: -2.2426, name: 'Parklife', location: 'Manchester, UK' },
        'parookaville': { lat: 51.1667, lng: 6.1333, name: 'Parookaville', location: 'Weeze, Germany' },
        'portola': { lat: 37.7749, lng: -122.3917, name: 'Portola', location: 'San Francisco, CA' },
        'primavera-sound-barcelona': { lat: 41.3873, lng: 2.192, name: 'Primavera Sound', location: 'Barcelona, Spain' },
        'project-z': { lat: 34.0689, lng: -117.648, name: 'Project Z', location: 'San Bernardino, CA' },
        'reading-festival': { lat: 51.4551, lng: -0.969, name: 'Reading Festival', location: 'Reading, UK' },
        'rolling-loud': { lat: 25.9579, lng: -80.2388, name: 'Rolling Loud', location: 'Miami, FL' },
        'second-sky': { lat: 37.7507, lng: -122.2006, name: 'Second Sky', location: 'Oakland, CA' },
        'shambhala': { lat: 49.3194, lng: -117.6437, name: 'Shambhala', location: 'Salmo River Ranch, BC' },
        'sonar-barcelona': { lat: 41.3819, lng: 2.177, name: 'Sónar Barcelona', location: 'Barcelona, Spain' },
        'sonic-bloom': { lat: 38.8859, lng: -106.9808, name: 'Sonic Bloom', location: 'Rye, CO' },
        'sonus-festival': { lat: 44.5333, lng: 14.9, name: 'Sonus Festival', location: 'Pag, Croatia' },
        'spring-awakening': { lat: 41.882, lng: -87.619, name: 'Spring Awakening', location: 'Chicago, IL' },
        'sxsw': { lat: 30.2672, lng: -97.7431, name: 'SXSW', location: 'Austin, TX' },
        'symbiosis': { lat: 39.62, lng: -122.19, name: 'Symbiosis', location: 'Oakdale, CA' },
        'sziget': { lat: 47.5438, lng: 19.0529, name: 'Sziget Festival', location: 'Budapest, Hungary' },
        'time-warp': { lat: 49.4896, lng: 8.4718, name: 'Time Warp', location: 'Mannheim, Germany' },
        'tomorrowland': { lat: 51.0909, lng: 4.3641, name: 'Tomorrowland', location: 'Boom, Belgium' },
        'tomorrowland-winter': { lat: 45.2116, lng: 6.6414, name: 'Tomorrowland Winter', location: 'Alpe d\'Huez, France' },
        'ultra-europe': { lat: 43.5147, lng: 16.4402, name: 'Ultra Europe', location: 'Split, Croatia' },
        'ultra-miami': { lat: 25.7826, lng: -80.1868, name: 'Ultra Miami', location: 'Miami, FL' },
        'ultra-music-festival': { lat: 25.7826, lng: -80.1868, name: 'Ultra Music Festival', location: 'Miami, FL' },
        'untold-festival': { lat: 46.767, lng: 23.58, name: 'UNTOLD Festival', location: 'Cluj-Napoca, Romania' },
        'wireless-festival': { lat: 51.5625, lng: -0.0744, name: 'Wireless Festival', location: 'London, UK' },
        'wobbleland': { lat: 37.3382, lng: -121.8863, name: 'Wobbleland', location: 'San Jose, CA' },
        'world-club-dome': { lat: 50.0333, lng: 8.5667, name: 'World Club Dome', location: 'Frankfurt, Germany' },
    };

    
    // Year colors